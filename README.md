# Описание проекта: Классификация назначений платежей

## Описание кейса

Цель проекта — разобрать и проанализировать текстовые назначения платежей, а также классифицировать их по определённым категориям. В ходе решения задачи учтены особенности данных:
- Некорректные или разнообразные форматы дат (например, 01.01.24, 01 января 2024).
- Разделители десятичных и тысячных разрядов.
- Наличие сокращений и аббревиатур в текстах.
- Присутствие орфографических ошибок.

### Примеры назначений платежей:
1. Оплата за транспортные услуги по доставке трансформатора из г.Нижневартовск в посёлок Ваховск по контракту/счету 0099721A/2 от 01.09.2023 г.
2. Оплата по счёту No686432 от 23 августа 2023 г. За предоставление неисключительных прав на ПО.
3. Комиссия за обслуживание по системе Клиент-Банк за период с 01/09/2024 по 30/09/2024. НДС не облагается.
4. Оплата за кофе в зернах по счету No123 от 15.09.2024. Сумма 10000,00 руб., в т.ч. НДС 20% 1666,67 руб.

## Классификация платежей

После обработки текстов назначений платежей осуществляется их классификация по следующим категориям:
- **BANK_SERVICE** — банковские услуги (кредиты, комиссии и сборы).
- **FOOD_GOODS** — продовольственные товары.
- **NON_FOOD_GOODS** — непродовольственные товары.
- **LEASING** — лизинг (финансовая аренда).
- **LOAN** — займы.
- **REALE_STATE** — недвижимость (покупка, аренда помещений).
- **SERVICE** — услуги.
- **TAX** — налоги, штрафы, социальные выплаты и заработная плата.
- **NOT_CLASSIFIED** — не поддаётся классификации.

## Решение

### Технологический стек
- **Язык программирования**: Python
- **Библиотеки**: 
  - `pandas` — работа с таблицами и данными.
  - `torch`, `transformers` — создание и обучение модели на основе BERT.
  - `pymorphy2` — нормализация слов для обработки текста.
  - `dateparser` — приведение дат к единому формату.
- **Модель**: BERT (на базе "rubert-tiny").
- **Контейнеризация**: Docker.

### Структура проекта
```plaintext
bert_classifier/
├── __pycache__/
├── dataset.py       # Определение датасета для обучения и предсказаний
├── model.py         # Класс для обучения и использования модели BERT
├── utils.py         # Функции предобработки текстов
├── data/
│   └── payments_main.tsv  # Основной набор данных
├── models/
│   ├── final_model.pt     # Обученная модель
│   └── README.md          # Текущее описание проекта
├── main.py          # Скрипт для запуска предсказаний
└── requirements.txt # Зависимости проекта


## Предобработка данных
- Текст очищается от лишних символов и приводится к нормальной форме с помощью библиотеки `pymorphy2`.
- Даты преобразуются в единый формат (дд.мм.гггг) с использованием `dateparser`.
- Сокращения заменяются на полные слова (например, "сч." → "счет").
- Числовые значения корректируются для единого вида десятичных и тысячных разделителей.

## Обучение модели
- Данные делятся на обучающую, валидационную и тестовую выборки (85%, 10%, 5%).
- Используется предобученная модель **BERT** с линейным классификатором на выходе.
- Оптимизация: **AdamW**, scheduler — **cosine schedule with warmup**.
- Функция потерь: **CrossEntropyLoss**.

## Предсказание
- Для предсказаний используется обученная модель. 
- Текстовые описания преобразуются с помощью токенизатора **BERT**, затем подаются в модель для получения предсказаний.

## Запуск проекта

### Установка зависимостей
Сначала установите необходимые библиотеки:
```bash
pip install -r requirements.txt

## Обучение модели
Запустите обучение модели:
```bash
python main.py
